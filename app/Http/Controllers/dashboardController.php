<?php

namespace App\Http\Controllers;

use App\Models\historicoaforo;
use App\Models\historicoetiquetados;
use App\Models\User;
use PDO;
use PDOException;

class dashboardController extends Controller
{

    public function testsoh()
    {
        return ["Hola"];
    }
    public function testsohrep()
    {

        $hostODS = 'fcods.trafficmanager.net';
        $dbNameODS = 'clientes_ods';
        $userODS = 'hmonroy';
        $passwordODS = 'Monroy2011@';
        $portODS = 3306;

        try {

            // ConexiÃ³n a la base de datos
            $pdo = new PDO("mysql:host=$hostODS;port=$portODS;dbname=$dbNameODS", $userODS, $passwordODS);

            // Preparar la consulta SQL
            // $query = "SELECT NombreFondeador, SUM(CantidadNombreFondeador) as SumaCantidadNombreFondeador FROM ( SELECT COUNT(DISTINCT fo_nombre) as CantidadNombreFondeador, GROUP_CONCAT(DISTINCT fo_nombre) as NombreFondeador FROM clientes_ods.d_saldos_hist sh LEFT JOIN clientes_ods.d_saldos s ON ( Sh_numclientesicap = s.ib_numclientesicap AND Sh_numsolicitudsicap = s.ib_numsolicitudsicap AND sh.origsistema = s.origsistema ) LEFT JOIN clientes_ods.d_ciclos_grupales cg ON ( s.ib_numclientesicap = cg.ci_numgrupo AND s.ib_numsolicitudsicap = cg.ci_numciclo AND s.origsistema = cg.origsistema AND ci_origenmigracion = 0 ) LEFT JOIN clientes_ods.c_fondeadores ON ( fo_numfondeador = sh_fondeo_garantia ) LEFT JOIN clientes_ods.c_sucursales ON (sh_numsucursal = su_numsucursal) LEFT JOIN clientes_ods.c_estados ON (su_estado = es_numestado) LEFT JOIN clientes_ods.c_operaciones ON (op_numoperacion = Sh_producto) WHERE sh_fecha_historico = DATE_FORMAT( DATE_SUB( CURDATE(), INTERVAL 1 DAY ), '%Y-%m-%d' ) AND sh_fecha_desembolso <= DATE_FORMAT( DATE_SUB( CURDATE(), INTERVAL 1 DAY ), '%Y-%m-%d' ) AND Sh_fondeador IN (1, 10, 16, 17) AND sh_estatus IN (1, 2, 3, 4, 5, 6) GROUP BY Sh_credito, Sh_numclientesicap, Sh_numsolicitudsicap ) AS subquery GROUP BY NombreFondeador;";
            $query = "SELECT NombreFondeador as nombrefondeador, COUNT(*) as cantidadregistros, SUM(sh_saldo_capital ) as monto from ( SELECT ( select fo_nombre from clientes_ods.c_fondeadores where sh_fondeador = fo_numfondeador ) as NombreFondeador, sh_saldo_capital FROM clientes_ods.d_saldos_hist sh LEFT JOIN clientes_ods.d_saldos s ON ( Sh_numclientesicap = s.ib_numclientesicap AND Sh_numsolicitudsicap = s.ib_numsolicitudsicap AND sh.origsistema = s.origsistema ) LEFT JOIN clientes_ods.d_ciclos_grupales cg ON ( s.ib_numclientesicap = cg.ci_numgrupo AND s.ib_numsolicitudsicap = cg.ci_numciclo AND s.origsistema = cg.origsistema AND ci_origenmigracion = 0 ) LEFT JOIN clientes_ods.c_fondeadores ON ( fo_numfondeador = sh_fondeo_garantia ) LEFT JOIN clientes_ods.c_sucursales ON (sh_numsucursal = su_numsucursal) LEFT JOIN clientes_ods.c_estados ON (su_estado = es_numestado) LEFT JOIN clientes_ods.c_operaciones ON (op_numoperacion = Sh_producto) WHERE sh.sh_estatus in (1,2) and sh_fecha_historico = DATE_FORMAT( DATE_SUB( CURDATE(), INTERVAL 1 DAY ), '%Y-%m-%d' ) AND sh_fecha_desembolso <= DATE_FORMAT( DATE_SUB( CURDATE(), INTERVAL 1 DAY ), '%Y-%m-%d' ) AND Sh_fondeador IN (1, 10, 16, 17) AND sh_estatus IN (1, 2, 3, 4, 5, 6) GROUP BY Sh_credito, Sh_numclientesicap, Sh_numsolicitudsicap ) as subquery group by NombreFondeador;";
            $statement = $pdo->prepare($query);

            // Ejecutar la consulta
            $statement->execute();

            // Obtener los resultados
            $results = $statement->fetchAll(PDO::FETCH_ASSOC);

            return $results;
        } catch (PDOException $e) {
            // Manejo de errores
            echo "Error: " . $e->getMessage();
        }

    }

    public function sohmambu()
    {
        $fechaActual = date("Y-m-d");

        try {
            $host = 'fcontigo-rs-cluster-01.cdxtyqbdsp7d.us-east-1.redshift.amazonaws.com';
            $port = '5439';
            $database = 'mambu_prod';
            $user = 'marcadodev';
            $password = 'marcadoDev00';
            $dsn = "pgsql:host=$host;port=$port;dbname=$database";
            $pdo = new PDO($dsn, $user, $password);
            $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

            // Ejemplo de consulta
            $formattedFechaMov = date("Y-m-d", strtotime($fechaActual . "-1 day"));
            $query = "SELECT fondeador as nombrefondeador, COUNT(*) as cantidadregistros, SUM(saldocapital) as monto from ( SELECT fondeador, sucursal as Sucursal, SUM(diasatraso) as dias_mora, SUM(saldocapital) as saldocapital FROM ( SELECT fondeador, acuerdocreditoequipo, equipo, sucursal, diasatraso, capitalotorgado, fechadesembolso, fechavencimiento, cuotastranscurridas, saldocapital, saldointeres, CASE WHEN saldocapital > 900000 THEN 900000 WHEN diasatraso > 21 THEN 0 ELSE saldocapital END as monto FROM mambu_prod.soh_mambu WHERE fechacorte = ( SELECT MAX(fechadesembolso) FROM mambu_prod.soh_mambu ) ) subconsulta GROUP by fondeador, acuerdocreditoequipo, equipo, sucursal ORDER BY acuerdocreditoequipo ) as squery GROUP BY fondeador;";


            $statement = $pdo->query($query);
            $result = $statement->fetchAll(PDO::FETCH_ASSOC);
            return $result;
            return response()->json(['success' => "Consulta realizada correctamente"], 200);

        } catch (\Throwable $th) {
            return $th;

            return response()->json(['error' => $th], 400);

        }

    }

    public function recuperarcontrasena()
    {
        $usuarios = User::select('id', 'name')->get();
        return view('recuperarcontrasena', ['usuarios' => $usuarios]);

    }

    public function calculofondeadorpromecap()
    {

        try {

            $ultimoRegistro = historicoaforo::latest('fecha')->first();
            $fechaHoy = date("Y-m-d");
            $fechaSinHora = substr($ultimoRegistro->fecha, 0, 10);

            if ($fechaSinHora == $fechaHoy) {
                return $ultimoRegistro->aforo;
            } else {

                //***************************************************EMPIEZA PREPARACION DE LOS JSON ***************************************** */
                // CONEXION JUCAVI
                $hostODS = 'fcods.trafficmanager.net';
                $dbNameODS = 'clientes_ods';
                $userODS = 'hmonroy';
                $passwordODS = 'Monroy2011@';
                $portODS = 3306;
                $pdoODS = new PDO("mysql:host=$hostODS;port=$portODS;dbname=$dbNameODS", $userODS, $passwordODS);

                $queryODS = "SELECT NombreFondeador as fondeador, sh_nombresucursal as sucursal, sum(monto) as monto from ( SELECT ( select fo_nombre from clientes_ods.c_fondeadores where sh_fondeador = fo_numfondeador ) as NombreFondeador, sh_credito, case when sh_saldo_capital > 900000 then 900000 when Sh_num_dias_mora > 21 then 0 else sh_saldo_capital end as monto, sh_nombresucursal FROM clientes_ods.d_saldos_hist sh LEFT JOIN clientes_ods.d_saldos s ON ( Sh_numclientesicap = s.ib_numclientesicap AND Sh_numsolicitudsicap = s.ib_numsolicitudsicap AND sh.origsistema = s.origsistema ) LEFT JOIN clientes_ods.d_ciclos_grupales cg ON ( s.ib_numclientesicap = cg.ci_numgrupo AND s.ib_numsolicitudsicap = cg.ci_numciclo AND s.origsistema = cg.origsistema AND ci_origenmigracion = 0 ) LEFT JOIN clientes_ods.c_fondeadores ON (fo_numfondeador = sh_fondeo_garantia) LEFT JOIN clientes_ods.c_sucursales ON (sh_numsucursal = su_numsucursal) LEFT JOIN clientes_ods.c_estados ON (su_estado = es_numestado) LEFT JOIN clientes_ods.c_operaciones ON (op_numoperacion = Sh_producto) WHERE sh.sh_estatus in (1, 2) and sh_fecha_historico = DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 DAY), '%Y-%m-%d' ) AND sh_fecha_desembolso <= DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 DAY), '%Y-%m-%d' ) AND Sh_fondeador IN (10) AND sh_estatus IN (1, 2, 3) GROUP by Sh_credito, Sh_numclientesicap, Sh_numsolicitudsicap ) as subquery2 group by sh_nombresucursal;";
                $statementODS = $pdoODS->prepare($queryODS);
                $statementODS->execute();
                $sucursalesjucavi = $statementODS->fetchAll(PDO::FETCH_ASSOC);

                // CONEXION MAMBU
                $host = 'fcontigo-rs-cluster-01.cdxtyqbdsp7d.us-east-1.redshift.amazonaws.com';
                $port = '5439';
                $database = 'mambu_prod';
                $user = 'marcadodev';
                $password = 'marcadoDev00';
                $dsn = "pgsql:host=$host;port=$port;dbname=$database";
                $pdo = new PDO($dsn, $user, $password);
                $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                $query = "SELECT fondeador, sucursal, SUM(monto_total) as monto from ( SELECT fondeador, acuerdocreditoequipo, sucursal, SUM(monto) as monto_total FROM ( SELECT fondeador , acuerdocreditoequipo , sucursal, CASE WHEN saldocapital > 900000 THEN 900000 WHEN diasatraso > 21 THEN 0 ELSE saldocapital END as monto FROM mambu_prod.soh_mambu WHERE fechacorte = ( SELECT MAX(fechadesembolso) FROM mambu_prod.soh_mambu ) AND fondeador = 'PROMECAP' ) subconsulta GROUP BY fondeador, acuerdocreditoequipo, sucursal ORDER BY acuerdocreditoequipo ) as subquery group by fondeador, sucursal;";
                $statement = $pdo->query($query);
                $sucursalesmambu = $statement->fetchAll(PDO::FETCH_ASSOC);

                $verdaderassucursales = '[{"sucursal_jucavi":"Acambaro","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Acapulco","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Centro","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Renacimieto","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Aguascalientes","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"Apatzingan","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apatzingan Madero","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apizaco","sucursal_real":"Apizaco Multiproducto","estado":"Tlaxcala"},{"sucursal_jucavi":"Atlacomulco","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Autlan","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Boca del Rio","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Bucerias","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Celaya Centro","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Chilapa","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Chilpancingo Norte","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Coatzacoalcos","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Colima","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Comitan","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Cosamaloapan","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Culiacan","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Dolores Hidalgo","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Durango","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Guadalajara Centro","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Guadalupe","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Guanajuato","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Hermosillo","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"Heroica Cardenas","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Huajuapan de Leon","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Iguala","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Ixtlahuaca","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Lagos de Moreno","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Lazaro Cardenas","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Leon Centro","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Lerdo","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Los Reyes","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Manzanillo","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Martinez de la Torre","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Matehuala","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Mazatlan","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Monterrey","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Monterrey Centro","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Morelia Camelinas","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Morelia Madero","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Navojoa","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Oaxaca","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Ocotlan de Morelos","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Orizaba","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Papantla","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Patzcuaro","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Puebla","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"Queretaro","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"Rio Verde","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Sahuayo","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Salamanca","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Saltillo","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"San Andres","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"San Juan del Rio","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"San Luis","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Centro","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Zona Industrial","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Santa Catarina","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Tacambaro","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Tala","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tapachula","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Tecpan de Galeana","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Tepic","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Tlajomulco","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tlaxiaco","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tonala Centro","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tonala Chiapas","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Torreon","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"Tuxtepec","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tuxtla","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Uruapan Centro","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Veracruz","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Villa Flores","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Villa Victoria","sucursal_real":"Villa Victoria Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Villahermosa Olmeca","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Zacapu","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zamora","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zihuatanejo","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Zitacuaro","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"CD Altamirano","sucursal_real":"CD Altamirano Multiproducto","estado":"Guerrero"}]';
                $estadosmambu = '[{"sucursal_jucavi":"Acambaro","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Acapulco","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Centro","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Renacimieto","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Aguascalientes","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"Apatzingan","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apatzingan Madero","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apizaco","sucursal_real":"Apizaco Multiproducto","estado":"Tlaxcala"},{"sucursal_jucavi":"Atlacomulco","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Autlan","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Boca del Rio","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Bucerias","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Celaya Centro","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Chilapa","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Chilpancingo Norte","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Coatzacoalcos","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Colima","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Comitan","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Cosamaloapan","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Culiacan","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Dolores Hidalgo","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Durango","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Guadalajara Centro","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Guadalupe","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Guanajuato","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Hermosillo","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"Heroica Cardenas","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Huajuapan de Leon","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Iguala","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Ixtlahuaca","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Lagos de Moreno","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Lazaro Cardenas","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Leon Centro","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Lerdo","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Los Reyes","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Manzanillo","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Martinez de la Torre","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Matehuala","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Mazatlan","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Monterrey","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Monterrey Centro","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Morelia Camelinas","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Morelia Madero","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Navojoa","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Oaxaca","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Ocotlan de Morelos","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Orizaba","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Papantla","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Patzcuaro","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Puebla","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"Queretaro","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"Rio Verde","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Sahuayo","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Salamanca","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Saltillo","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"San Andres","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"San Juan del Rio","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"San Luis","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Centro","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Zona Industrial","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Santa Catarina","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Tacambaro","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Tala","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tapachula","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Tecpan de Galeana","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Tepic","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Tlajomulco","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tlaxiaco","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tonala Centro","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tonala Chiapas","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Torreon","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"Tuxtepec","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tuxtla","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Uruapan Centro","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Veracruz","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Villa Flores","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Villa Victoria","sucursal_real":"Villa Victoria Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Villahermosa Olmeca","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Zacapu","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zamora","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zihuatanejo","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Zitacuaro","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Xochimilco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santa Cruz Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Valle de Chalco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chalco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tulyehualco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ayotla Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Lorenzo Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pantitlan Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Milpa Alta Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"La Joya Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iztapalapa Oriente Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iztacalco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ixtapaluca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Eduardo Molina Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chimalhuacan Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cafetales Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ajusco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pachuca Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pijijiapan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Puerto Vallarta Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Cristobal Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Martin Texmelucan Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santiago Ixcuintla Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Silao Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Suchiate Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Conmigo Vales Hermosillo","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuernavaca Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acayucan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Actopan Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tapachula Norte Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Taxco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecamac Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecamachalco Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecoman Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Teziutlan Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tierra Blanca Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Toluca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tula Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tulancingo Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxpan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtla Libramiento Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villa Cuauhtemoc Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villahermosa Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Xalapa Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zacatecas Multiproducto","estado":"Zacatecas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zapopan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zinacantepec Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zumpango Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Atoyac Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Catemaco Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cd Hidalgo Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cd Obregon Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Celaya Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilpancingo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cocula Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cordoba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuajimalpa Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuautla Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuernavaca Boulevard Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Etla Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Gomez Palacio Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalajara Oblatos Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guamuchil Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Huahuchinango Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Irapuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Jojutla Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Juchitan Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"La Piedad Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lerma Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Loreto Multiproducto","estado":"Zacatecas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Los Mochis Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Macuspana Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Miahuatlan Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Minatitlan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Moroleon Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Neza Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ocotlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"CD Altamirano","sucursal_real":"CD Altamirano Multiproducto","estado":"Guerrero"}]';

                $sucursales = json_decode($verdaderassucursales, true);

                $countjucavi = count($sucursalesjucavi);
                $countsucursales = count($sucursales);

                // Se coloca la sucursal verdadera y estado de jucavi
                for ($i = 0; $i < $countjucavi; $i++) {
                    for ($j = 0; $j < $countsucursales; $j++) {
                        if ($sucursalesjucavi[$i]["sucursal"] === $sucursales[$j]["sucursal_jucavi"]) {
                            $sucursalesjucavi[$i]["sucursal"] = $sucursales[$j]["sucursal_real"];
                            $sucursalesjucavi[$i]["estado"] = $sucursales[$j]["estado"];
                            break; // Terminamos la bÃºsqueda una vez que se encuentra una coincidencia
                        }
                    }
                }

                $estadosmambuarray = json_decode($estadosmambu, true);
                // Se colola el estado a mambu
                $countmambu = count($sucursalesmambu);
                $countsucursales = count($estadosmambuarray);

                for ($i = 0; $i < $countmambu; $i++) {
                    for ($j = 0; $j < $countsucursales; $j++) {
                        if ($sucursalesmambu[$i]["sucursal"] === $estadosmambuarray[$j]["sucursal_real"]) {
                            $sucursalesmambu[$i]["estado"] = $estadosmambuarray[$j]["estado"];
                            break; // Terminamos la bÃºsqueda una vez que se encuentra una coincidencia
                        }
                    }
                }

                //***************************************************TERMINA PREPARACION DE LOS JSON ***************************************** */

                //***************************************************EMPIEZA CALCULOS DE SUCURSALES ***************************************** */

                $tsucursales = '[{"sucursal":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal":"Actopan Multiproducto","estado":"Hidalgo"},{"sucursal":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Apizaco Multiproducto","estado":"Tlaxcala"},{"sucursal":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal":"Ayotla Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal":"CD Altamirano Multiproducto","estado":"Guerrero"},{"sucursal":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal":"Chalco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal":"Chimalhuacan Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal":"Colima Multiproducto","estado":"Colima"},{"sucursal":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal":"Cuautla Multiproducto","estado":"Morelos"},{"sucursal":"Cuernavaca Multiproducto","estado":"Morelos"},{"sucursal":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal":"Durango Multiproducto","estado":"Durango"},{"sucursal":"Eduardo Molina Multiproducto","estado":"CDMX"},{"sucursal":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Iztacalco Multiproducto","estado":"CDMX"},{"sucursal":"Iztapalapa Oriente Multiproducto","estado":"CDMX"},{"sucursal":"Jojutla Multiproducto","estado":"Morelos"},{"sucursal":"La Joya Multiproducto","estado":"CDMX"},{"sucursal":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal":"Lerdo Multiproducto","estado":"Durango"},{"sucursal":"Lerma Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal":"Neza Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal":"Pachuca Multiproducto","estado":"Hidalgo"},{"sucursal":"Pantitlan Multiproducto","estado":"CDMX"},{"sucursal":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Puebla Multiproducto","estado":"Puebla"},{"sucursal":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal":"Santa Cruz Multiproducto","estado":"CDMX"},{"sucursal":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Tala Multiproducto","estado":"Jalisco"},{"sucursal":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal":"Tecamac Multiproducto","estado":"Hidalgo"},{"sucursal":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal":"Toluca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal":"Tula Multiproducto","estado":"Hidalgo"},{"sucursal":"Tulyehualco Multiproducto","estado":"CDMX"},{"sucursal":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal":"Villa Victoria Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal":"Xochimilco Multiproducto","estado":"CDMX"},{"sucursal":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal":"Zumpango Multiproducto","estado":"Estado de MÃ©xico"}]';
                $sucursales = json_decode($tsucursales, true);

                for ($i = 0; $i < count($sucursales); $i++) {

                    $sucursal = $sucursales[$i]; // Usamos una referencia para poder modificar el elemento actual

                    // Buscar la sucursal en $tjucavi
                    $tjucaviMatch = null;
                    foreach ($sucursalesjucavi as $item) {
                        if ($item['sucursal'] === $sucursal['sucursal']) {
                            $tjucaviMatch = $item;
                            break; // Salir del bucle una vez que se encuentre una coincidencia
                        }
                    }

                    // Buscar la sucursal en $tmpmambu
                    $tmpmambuMatch = null;
                    foreach ($sucursalesmambu as $item) {
                        if ($item['sucursal'] === $sucursal['sucursal']) {
                            $tmpmambuMatch = $item;
                            break; // Salir del bucle una vez que se encuentre una coincidencia
                        }
                    }

                    // Calcular el saldo capital si se encuentran coincidencias
                    $saldoCapital = 0;
                    if (!is_null($tmpmambuMatch)) {
                        $saldoCapital += floatval($tmpmambuMatch['monto']);
                    }
                    if (!is_null($tjucaviMatch)) {
                        $saldoCapital += floatval($tjucaviMatch['monto']);
                    }

                    // AÃ±adir el campo saldo_capital
                    $sucursales[$i]['saldo_capital'] = number_format($saldoCapital, 2); // Formatear el nÃºmero si es necesario
                }

                //***************************************************EMPIEZA CALCULOS DE SUCURSALES ***************************************** */

                //***************************************************EMPIEZA CALCULOS DE PORCENTAJES ***************************************** */

                $suma_total = 0.0; // Inicializa la suma total

                foreach ($sucursales as $item) {
                    $saldo_capital = floatval(str_replace(',', '', $item['saldo_capital']));
                    $suma_total += $saldo_capital;
                }

                $saldomaximo = $suma_total * 0.05;

                // Calcula el porcentaje proporcional para cada elemento y agrega el campo "porcentaje"
                for ($i = 0; $i < count($sucursales); $i++) {
                    $saldo_capital = $sucursales[$i]['saldo_capital'];
                    $saldocasteado = floatval(str_replace(',', '', $saldo_capital));

                    if ($saldocasteado > $saldomaximo) {
                        $sucursales[$i]['saldo_capital'] = number_format($saldomaximo, 2);
                        $porcentaje = number_format(5.00, 2);
                        $sucursales[$i]["porcentaje"] = number_format($porcentaje, 2);
                    } else {
                        $porcentaje = ($saldocasteado / $suma_total) * 100;
                        $sucursales[$i]["porcentaje"] = number_format($porcentaje, 2);
                    }

                }

                //***************************************************TERMINA CALCULOS DE PORCENTAJES ***************************************** */

                //***************************************************TERMINA CALCULOS POR ESTADOS ***************************************** */
                $saldos_por_estado = array();

                // Recorre el arreglo de sucursales
                foreach ($sucursales as $item) {
                    $estado = $item['estado'];
                    $saldo_capital = floatval(str_replace(',', '', $item['saldo_capital'])); // Convierte el saldo a flotante

                    // Si el estado ya existe en el arreglo $saldos_por_estado, suma el saldo al valor existente
                    if (isset($saldos_por_estado[$estado])) {
                        $saldos_por_estado[$estado] += $saldo_capital;
                    } else {
                        // Si el estado no existe, crea una nueva entrada con el saldo actual
                        $saldos_por_estado[$estado] = $saldo_capital;
                    }
                }

                $suma_total_estados = array_sum($saldos_por_estado);

                $arreglo_estados_porcentajes = array();

                foreach ($saldos_por_estado as $estado => $valor) {
                    $porcentaje = ($valor / $suma_total_estados) * 100;
                    $tmparray = [
                        "estado" => $estado,
                        "saldo" => $valor,
                        "porcentaje" => $porcentaje,
                    ];
                    array_push($arreglo_estados_porcentajes, $tmparray);
                }

                for ($i = 0; $i < count($arreglo_estados_porcentajes); $i++) {
                    switch ($arreglo_estados_porcentajes[$i]["estado"]) {
                        case 1:
                            echo "CDMX";
                            if ($value["porcentaje"] > 30.00) {
                                $arreglo_estados_porcentajes[$i]["saldo"] = $suma_total_estados * 0.3;
                                $arreglo_estados_porcentajes[$i]["porcentaje"] = 30.0;
                            }
                            break;
                        case 2:
                            echo "Estado de MÃ©xico";
                            if ($value["porcentaje"] > 30.00) {
                                $arreglo_estados_porcentajes[$i]["saldo"] = $suma_total_estados * 0.3;
                                $arreglo_estados_porcentajes[$i]["porcentaje"] = 20.0;
                            }
                            break;
                        case 3:
                            echo "MichoacÃ¡n de Ocampo";
                            if ($value["porcentaje"] > 20.00) {
                                $arreglo_estados_porcentajes[$i]["saldo"] = $suma_total_estados * 0.2;
                                $arreglo_estados_porcentajes[$i]["porcentaje"] = 20.0;
                            }
                            break;
                        default:

                    }

                }

                //***************************************************TERMINA CALCULOS POR ESTADOS ***************************************** */

                $aforo_calculado = 0.0;

                foreach ($arreglo_estados_porcentajes as $key => $value) {
                    $aforo_calculado += $value["saldo"];
                }
                // return (["SUCURSALES" => $sucursales, "ESTADOS" => $arreglo_estados_porcentajes]);

                $nuevoRegistro = new historicoaforo;
                $nuevoRegistro->fondeador = 'PROMECAP';
                $nuevoRegistro->aforo = $aforo_calculado;
                $nuevoRegistro->fecha = $fechaHoy;
                $nuevoRegistro->save();

                return $aforo_calculado;
            }

        } catch (\Throwable $th) {
            return $th->getMessage();
        }

    }

    public function historicoaforopromecap()
    {
        $fechaUnMesAtras = now()->subMonth();
        $registros = historicoaforo::whereBetween('fecha', [$fechaUnMesAtras, now()])->get();
        return $registros;
    }

    public function preetiquetadopreviopromecapconjunto()
    {
        // Conexion a ODS
        $host = 'fcods.trafficmanager.net';
        $dbName = 'clientes_ods';
        $user = 'hmonroy';
        $password = 'Monroy2011@';
        $port = 3306;

        try {
            // ConexiÃ³n a la base de datos
            $pdo = new PDO("mysql:host=$host;port=$port;dbname=$dbName", $user, $password);

            // Preparar la consulta SQL
            ini_set('max_execution_time', 300);
            $query = "call clientes_ods.SP_ListaPrevioPromecapNuevo('" . $fechaMenosUnDia . "');";
            $statement = $pdo->prepare($query);

            // Ejecutar la consulta
            $statement->execute();

            // Obtener los resultados
            $posts = $statement->fetchAll(PDO::FETCH_ASSOC);

            return $posts;

        } catch (PDOException $e) {
            // Manejo de errores
            echo "Error: " . $e->getMessage();
        }

    }

    public function get_creditos_promecap_aforo()
    {

        //***************************************************EMPIEZA PREPARACION DE LOS JSON ***************************************** */
        // CONEXION JUCAVI
        $hostODS = 'fcods.trafficmanager.net';
        $dbNameODS = 'clientes_ods';
        $userODS = 'hmonroy';
        $passwordODS = 'Monroy2011@';
        $portODS = 3306;
        $pdoODS = new PDO("mysql:host=$hostODS;port=$portODS;dbname=$dbNameODS", $userODS, $passwordODS);

        $queryODS = "SELECT Sh_credito as Credito, 'JUCAVI' as Sistema, sh_nombrecliente as \"NOMBRE GRUPO\", sh_nombresucursal as Sucursal, Sh_num_dias_mora as \"DIAS MORA\", sh_monto_credito as \"MONTO OTORGADO\", sh_fecha_desembolso as \"FECHA DESEMBOLSO\", sh_fecha_vencimiento as \"FECHA VENCIMIENTO\", sh_num_cuotas_trancurridas as \"CUOTAS RESTANTES\", sh_saldo_capital as \"SALDO CAPITAL\", sh_saldo_interes as \"SALDO INTERES\" FROM clientes_ods.d_saldos_hist sh LEFT JOIN clientes_ods.d_saldos s ON ( Sh_numclientesicap = s.ib_numclientesicap AND Sh_numsolicitudsicap = s.ib_numsolicitudsicap AND sh.origsistema = s.origsistema ) LEFT JOIN clientes_ods.d_ciclos_grupales cg ON ( s.ib_numclientesicap = cg.ci_numgrupo AND s.ib_numsolicitudsicap = cg.ci_numciclo AND s.origsistema = cg.origsistema AND ci_origenmigracion = 0 ) LEFT JOIN clientes_ods.c_fondeadores ON (fo_numfondeador = sh_fondeo_garantia) LEFT JOIN clientes_ods.c_sucursales ON (sh_numsucursal = su_numsucursal) LEFT JOIN clientes_ods.c_estados ON (su_estado = es_numestado) LEFT JOIN clientes_ods.c_operaciones ON (op_numoperacion = Sh_producto) WHERE sh.sh_estatus in (1, 2) and sh_fecha_historico = DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 DAY), '%Y-%m-%d' ) AND sh_fecha_desembolso <= DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 DAY), '%Y-%m-%d' ) AND Sh_fondeador IN (10) AND sh_estatus IN (1, 2, 3) GROUP by Sh_credito, Sh_numclientesicap, Sh_numsolicitudsicap;";

        $statementODS = $pdoODS->prepare($queryODS);
        $statementODS->execute();
        $sucursalesjucavi = $statementODS->fetchAll(PDO::FETCH_ASSOC);

        // CONEXION MAMBU
        $host = 'fcontigo-rs-cluster-01.cdxtyqbdsp7d.us-east-1.redshift.amazonaws.com';
        $port = '5439';
        $database = 'mambu_prod';
        $user = 'marcadodev';
        $password = 'marcadoDev00';
        $dsn = "pgsql:host=$host;port=$port;dbname=$database";
        $pdo = new PDO($dsn, $user, $password);
        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        $query = "SELECT acuerdocreditoequipo as Credito, 'MAMBU' as Sistema, equipo as \"Nombre GRUPO\", sucursal as Sucursal, SUM(monto) as \"SALDO CAPITAL\", SUM(diasatraso) as \"DIAS MORA\", SUM(capitalotorgado) as \"MONTO OTORGADO\", MAX(fechadesembolso) as \"FECHA DESEMBOLSO\", MAX(fechavencimiento) as \"FECHA VENCIMIENTO\", SUM(cuotastranscurridas) as \"CUOTAS RESTANTES\", SUM(saldocapital) as \"SALDO CAPITAL\", SUM(saldointeres) as \"SALDO INTERES\" FROM ( SELECT acuerdocreditoequipo, equipo, sucursal, diasatraso, capitalotorgado, fechadesembolso, fechavencimiento, cuotastranscurridas, saldocapital, saldointeres, CASE WHEN saldocapital > 900000 THEN 900000 WHEN diasatraso > 21 THEN 0 ELSE saldocapital END as monto FROM mambu_prod.soh_mambu WHERE fechacorte = ( SELECT MAX(fechadesembolso) FROM mambu_prod.soh_mambu ) AND fondeador = 'PROMECAP' ) subconsulta GROUP BY acuerdocreditoequipo, equipo, sucursal ORDER BY acuerdocreditoequipo;";
        $statement = $pdo->query($query);
        $sucursalesmambu = $statement->fetchAll(PDO::FETCH_ASSOC);

        $verdaderassucursales = '[{"sucursal_jucavi":"Acambaro","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Acapulco","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Centro","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Renacimieto","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Aguascalientes","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"Apatzingan","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apatzingan Madero","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apizaco","sucursal_real":"Apizaco Multiproducto","estado":"Tlaxcala"},{"sucursal_jucavi":"Atlacomulco","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Autlan","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Boca del Rio","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Bucerias","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Celaya Centro","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Chilapa","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Chilpancingo Norte","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Coatzacoalcos","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Colima","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Comitan","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Cosamaloapan","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Culiacan","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Dolores Hidalgo","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Durango","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Guadalajara Centro","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Guadalupe","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Guanajuato","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Hermosillo","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"Heroica Cardenas","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Huajuapan de Leon","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Iguala","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Ixtlahuaca","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Lagos de Moreno","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Lazaro Cardenas","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Leon Centro","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Lerdo","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Los Reyes","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Manzanillo","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Martinez de la Torre","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Matehuala","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Mazatlan","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Monterrey","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Monterrey Centro","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Morelia Camelinas","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Morelia Madero","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Navojoa","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Oaxaca","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Ocotlan de Morelos","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Orizaba","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Papantla","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Patzcuaro","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Puebla","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"Queretaro","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"Rio Verde","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Sahuayo","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Salamanca","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Saltillo","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"San Andres","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"San Juan del Rio","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"San Luis","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Centro","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Zona Industrial","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Santa Catarina","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Tacambaro","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Tala","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tapachula","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Tecpan de Galeana","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Tepic","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Tlajomulco","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tlaxiaco","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tonala Centro","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tonala Chiapas","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Torreon","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"Tuxtepec","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tuxtla","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Uruapan Centro","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Veracruz","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Villa Flores","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Villa Victoria","sucursal_real":"Villa Victoria Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Villahermosa Olmeca","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Zacapu","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zamora","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zihuatanejo","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Zitacuaro","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"CD Altamirano","sucursal_real":"CD Altamirano Multiproducto","estado":"Guerrero"}]';
        $estadosmambu = '[{"sucursal_jucavi":"Acambaro","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Acapulco","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Centro","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Renacimieto","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Aguascalientes","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"Apatzingan","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apatzingan Madero","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apizaco","sucursal_real":"Apizaco Multiproducto","estado":"Tlaxcala"},{"sucursal_jucavi":"Atlacomulco","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Autlan","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Boca del Rio","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Bucerias","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Celaya Centro","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Chilapa","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Chilpancingo Norte","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Coatzacoalcos","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Colima","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Comitan","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Cosamaloapan","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Culiacan","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Dolores Hidalgo","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Durango","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Guadalajara Centro","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Guadalupe","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Guanajuato","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Hermosillo","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"Heroica Cardenas","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Huajuapan de Leon","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Iguala","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Ixtlahuaca","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Lagos de Moreno","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Lazaro Cardenas","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Leon Centro","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Lerdo","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Los Reyes","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Manzanillo","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Martinez de la Torre","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Matehuala","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Mazatlan","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Monterrey","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Monterrey Centro","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Morelia Camelinas","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Morelia Madero","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Navojoa","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Oaxaca","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Ocotlan de Morelos","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Orizaba","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Papantla","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Patzcuaro","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Puebla","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"Queretaro","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"Rio Verde","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Sahuayo","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Salamanca","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Saltillo","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"San Andres","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"San Juan del Rio","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"San Luis","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Centro","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Zona Industrial","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Santa Catarina","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Tacambaro","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Tala","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tapachula","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Tecpan de Galeana","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Tepic","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Tlajomulco","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tlaxiaco","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tonala Centro","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tonala Chiapas","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Torreon","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"Tuxtepec","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tuxtla","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Uruapan Centro","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Veracruz","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Villa Flores","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Villa Victoria","sucursal_real":"Villa Victoria Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Villahermosa Olmeca","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Zacapu","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zamora","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zihuatanejo","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Zitacuaro","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Xochimilco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santa Cruz Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Valle de Chalco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chalco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tulyehualco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ayotla Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Lorenzo Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pantitlan Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Milpa Alta Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"La Joya Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iztapalapa Oriente Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iztacalco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ixtapaluca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Eduardo Molina Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chimalhuacan Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cafetales Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ajusco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pachuca Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pijijiapan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Puerto Vallarta Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Cristobal Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Martin Texmelucan Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santiago Ixcuintla Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Silao Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Suchiate Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Conmigo Vales Hermosillo","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuernavaca Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acayucan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Actopan Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tapachula Norte Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Taxco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecamac Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecamachalco Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecoman Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Teziutlan Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tierra Blanca Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Toluca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tula Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tulancingo Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxpan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtla Libramiento Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villa Cuauhtemoc Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villahermosa Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Xalapa Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zacatecas Multiproducto","estado":"Zacatecas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zapopan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zinacantepec Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zumpango Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Atoyac Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Catemaco Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cd Hidalgo Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cd Obregon Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Celaya Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilpancingo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cocula Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cordoba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuajimalpa Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuautla Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuernavaca Boulevard Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Etla Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Gomez Palacio Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalajara Oblatos Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guamuchil Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Huahuchinango Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Irapuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Jojutla Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Juchitan Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"La Piedad Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lerma Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Loreto Multiproducto","estado":"Zacatecas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Los Mochis Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Macuspana Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Miahuatlan Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Minatitlan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Moroleon Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Neza Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ocotlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"CD Altamirano","sucursal_real":"CD Altamirano Multiproducto","estado":"Guerrero"}]';

        $sucursales = json_decode($verdaderassucursales, true);

        $countjucavi = count($sucursalesjucavi);
        $countsucursales = count($sucursales);

        // Se coloca la sucursal verdadera y estado de jucavi
        for ($i = 0; $i < $countjucavi; $i++) {
            for ($j = 0; $j < $countsucursales; $j++) {
                if ($sucursalesjucavi[$i]["Sucursal"] === $sucursales[$j]["sucursal_jucavi"]) {
                    $sucursalesjucavi[$i]["Sucursal"] = $sucursales[$j]["sucursal_real"];
                    $sucursalesjucavi[$i]["estado"] = $sucursales[$j]["estado"];
                    break; // Terminamos la bÃºsqueda una vez que se encuentra una coincidencia
                }
            }
        }

        $estadosmambuarray = json_decode($estadosmambu, true);
        // Se colola el estado a mambu
        $countmambu = count($sucursalesmambu);
        $countsucursales = count($estadosmambuarray);

        for ($i = 0; $i < $countmambu; $i++) {
            for ($j = 0; $j < $countsucursales; $j++) {
                if ($sucursalesmambu[$i]["sucursal"] === $estadosmambuarray[$j]["sucursal_real"]) {
                    $sucursalesmambu[$i]["estado"] = $estadosmambuarray[$j]["estado"];
                    break; // Terminamos la bÃºsqueda una vez que se encuentra una coincidencia
                }
            }
        }
        $creditos= array();
        foreach ($sucursalesmambu as $element) {
            $newData["Credito"]= $element["credito"];
            $newData["Sistema"]= $element["sistema"];
            $newData["NOMBRE GRUPO"]= $element["nombre grupo"];
            $newData["Sucursal"]= $element["sucursal"];
            $newData["DIAS MORA"]= $element["dias mora"];
            $newData["MONTO OTORGADO"]= $element["fecha desembolso"];
            $newData["FECHA DESEMBOLSO"]= $element["fecha desembolso"];
            $newData["FECHA VENCIMIENTO"]= $element["fecha vencimiento"];
            $newData["CUOTAS RESTANTES"]= $element["cuotas restantes"];
            $newData["SALDO CAPITAL"]= $element["saldo capital"];
            $newData["SALDO INTERES"]= $element["saldo interes"];
            $newData["estado"]= $element["estado"];
            $creditos[] = $newData;
        }
        $unido = array_merge($sucursalesjucavi, $creditos);

//                 return (["Jucavi"=>$sucursalesjucavi,"Mambu"=>$sucursalesmambu, "Unificado"=> $unido, "Cantidad"=>count($unido)]);
        return $unido;

        //***************************************************TERMINA PREPARACION DE LOS JSON ***************************************** */

    }

    public function obtenerFechaCorte()
    {
        $fecha = historicoetiquetados::select('fecha')
        ->orderBy('fecha', 'desc')
        ->first();
        return $fecha;
    }

    public function get_creditos_promecap_anexo_a()
    {
        $creditosJucavi = historicoetiquetados::select('creditos')
        ->where('sistema','=','JUCAVI')
        ->orderBy('fecha', 'desc')
        ->first();
        $creditosJucaviJoin = json_decode($creditosJucavi, true);
        $creditosJucaviFinales = $creditosJucaviJoin["creditos"];
        $creditosJucaviFinales = substr($creditosJucaviFinales, 2, strlen($creditosJucaviFinales) - 2);
        $creditosJucaviFinales = substr($creditosJucaviFinales, 0, strlen($creditosJucaviFinales) - 2);
        //$creditosFinales = json_decode($creditosFinales, true);
        //return $creditosFinales;

        //***************************************************EMPIEZA PREPARACION DE LOS JSON ***************************************** */
        // CONEXION JUCAVI
        $hostODS = 'fcods.trafficmanager.net';
        $dbNameODS = 'clientes_ods';
        $userODS = 'hmonroy';
        $passwordODS = 'Monroy2011@';
        $portODS = 3306;
        $pdoODS = new PDO("mysql:host=$hostODS;port=$portODS;dbname=$dbNameODS", $userODS, $passwordODS);

        $queryODS = "SELECT Sh_credito as credito, sh_nombrecliente as \"nombre grupo\", sh_monto_credito as \"monto otorgado\", sh_fecha_desembolso as \"fecha desembolso\", sh_fecha_vencimiento as \"fecha vencimiento\", sh_saldo_capital as \"saldo capital\", sh_saldo_interes as \"saldo interes\", sh_saldo_iva_interes as \"saldo interes iva\",
        sh_num_cuotas_trancurridas as \"cuotas restantes\", sh_periodicidad as \"periodicidad\", sh_nombreSucursal as \"sucursal\"
        FROM clientes_ods.d_saldos_hist sh
        LEFT JOIN clientes_ods.d_saldos s ON ( Sh_numclientesicap = s.ib_numclientesicap AND Sh_numsolicitudsicap = s.ib_numsolicitudsicap AND sh.origsistema = s.origsistema )
        LEFT JOIN clientes_ods.d_ciclos_grupales cg ON ( s.ib_numclientesicap = cg.ci_numgrupo AND s.ib_numsolicitudsicap = cg.ci_numciclo AND s.origsistema = cg.origsistema AND ci_origenmigracion = 0 )
        LEFT JOIN clientes_ods.c_fondeadores ON (fo_numfondeador = sh_fondeo_garantia)
        LEFT JOIN clientes_ods.c_sucursales ON (sh_numsucursal = su_numsucursal)
        LEFT JOIN clientes_ods.c_estados ON (su_estado = es_numestado)
        LEFT JOIN clientes_ods.c_operaciones ON (op_numoperacion = Sh_producto)
        WHERE sh.sh_estatus in (1, 2) and sh_fecha_historico = DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 DAY), '%Y-%m-%d' )
        AND sh_fecha_desembolso <= DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 DAY), '%Y-%m-%d' ) AND Sh_fondeador IN (10) AND sh_estatus IN (1, 2, 3)
        AND Sh_credito in ($creditosJucaviFinales)
        GROUP by Sh_credito, Sh_numclientesicap, Sh_numsolicitudsicap;";

        //return $queryODS;

        $statementODS = $pdoODS->prepare($queryODS);
        $statementODS->execute();
        $sucursalesjucavi = $statementODS->fetchAll(PDO::FETCH_ASSOC);

        //********************************************************************************************************************************************************************** */

        $creditosMambu = historicoetiquetados::select('creditos')
        ->where('sistema','=','MAMBU')
        ->orderBy('fecha', 'desc')
        ->first();
        $creditosMambuJoin = json_decode($creditosMambu, true);
        $creditosMambuFinales = $creditosMambuJoin["creditos"];
        $creditosMambuFinales = substr($creditosMambuFinales, 2, strlen($creditosMambuFinales) - 2);
        $creditosMambuFinales = substr($creditosMambuFinales, 0, strlen($creditosMambuFinales) - 2);
        $creditosMambuFinales = str_replace('"',"'", $creditosMambuFinales);
        //$cadena_con_comillas_simples = str_replace('"', "'", $cadena_con_comillas_dobles);
        //$creditosMambuFinales = json_decode($creditosMambuFinales, true);
        //return $creditosMambuFinales;

        // CONEXION MAMBU
        $host = 'fcontigo-rs-cluster-01.cdxtyqbdsp7d.us-east-1.redshift.amazonaws.com';
        $port = '5439';
        $database = 'mambu_prod';
        $user = 'marcadodev';
        $password = 'marcadoDev00';
        $dsn = "pgsql:host=$host;port=$port;dbname=$database";
        $pdo = new PDO($dsn, $user, $password);
        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        $query = "SELECT acuerdocreditoequipo as credito, equipo as \"nombre grupo\", SUM(capitalotorgado) as \"monto otorgado\", MAX(fechadesembolso) as \"fecha desembolso\",
        MAX(fechavencimiento) as \"fecha vencimiento\", SUM(saldocapital) as \"saldo capital\", SUM(saldointeres) as \"saldo interes\", SUM(saldoiva) as \"saldo interes iva\",
        SUM(cuotastranscurridas) as \"cuotas restantes\", 1 as \"periodicidad\", sucursal as \"sucursal\"
        FROM ( SELECT acuerdocreditoequipo, equipo, sucursal, diasatraso, capitalotorgado, fechadesembolso, fechavencimiento, cuotastranscurridas, saldocapital, saldointeres,
        saldoiva,
        CASE WHEN saldocapital > 900000 THEN 900000 WHEN diasatraso > 21 THEN 0 ELSE saldocapital END as monto FROM mambu_prod.soh_mambu WHERE fechacorte = ( SELECT MAX(fechadesembolso) FROM mambu_prod.soh_mambu ) AND fondeador = 'PROMECAP' AND acuerdocreditoequipo in ($creditosMambuFinales)) subconsulta GROUP BY acuerdocreditoequipo, equipo, sucursal ORDER BY acuerdocreditoequipo;";

        //return $query;

        $statement = $pdo->query($query);
        $sucursalesmambu = $statement->fetchAll(PDO::FETCH_ASSOC);

        $verdaderassucursales = '[{"sucursal_jucavi":"Acambaro","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Acapulco","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Centro","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Renacimieto","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Aguascalientes","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"Apatzingan","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apatzingan Madero","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apizaco","sucursal_real":"Apizaco Multiproducto","estado":"Tlaxcala"},{"sucursal_jucavi":"Atlacomulco","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Autlan","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Boca del Rio","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Bucerias","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Celaya Centro","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Chilapa","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Chilpancingo Norte","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Coatzacoalcos","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Colima","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Comitan","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Cosamaloapan","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Culiacan","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Dolores Hidalgo","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Durango","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Guadalajara Centro","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Guadalupe","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Guanajuato","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Hermosillo","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"Heroica Cardenas","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Huajuapan de Leon","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Iguala","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Ixtlahuaca","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Lagos de Moreno","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Lazaro Cardenas","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Leon Centro","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Lerdo","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Los Reyes","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Manzanillo","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Martinez de la Torre","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Matehuala","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Mazatlan","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Monterrey","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Monterrey Centro","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Morelia Camelinas","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Morelia Madero","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Navojoa","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Oaxaca","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Ocotlan de Morelos","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Orizaba","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Papantla","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Patzcuaro","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Puebla","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"Queretaro","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"Rio Verde","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Sahuayo","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Salamanca","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Saltillo","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"San Andres","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"San Juan del Rio","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"San Luis","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Centro","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Zona Industrial","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Santa Catarina","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Tacambaro","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Tala","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tapachula","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Tecpan de Galeana","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Tepic","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Tlajomulco","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tlaxiaco","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tonala Centro","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tonala Chiapas","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Torreon","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"Tuxtepec","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tuxtla","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Uruapan Centro","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Veracruz","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Villa Flores","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Villa Victoria","sucursal_real":"Villa Victoria Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Villahermosa Olmeca","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Zacapu","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zamora","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zihuatanejo","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Zitacuaro","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"CD Altamirano","sucursal_real":"CD Altamirano Multiproducto","estado":"Guerrero"}]';
        $estadosmambu = '[{"sucursal_jucavi":"Acambaro","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Acapulco","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Centro","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Acapulco Renacimieto","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Aguascalientes","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"Apatzingan","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apatzingan Madero","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Apizaco","sucursal_real":"Apizaco Multiproducto","estado":"Tlaxcala"},{"sucursal_jucavi":"Atlacomulco","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Autlan","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Boca del Rio","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Bucerias","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Celaya Centro","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Chilapa","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Chilpancingo Norte","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Coatzacoalcos","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Colima","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Comitan","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Cosamaloapan","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Culiacan","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Dolores Hidalgo","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Durango","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Guadalajara Centro","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Guadalupe","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Guanajuato","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Hermosillo","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"Heroica Cardenas","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Huajuapan de Leon","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Iguala","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Ixtlahuaca","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Lagos de Moreno","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Lazaro Cardenas","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Leon Centro","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Lerdo","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"Los Reyes","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Manzanillo","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"Martinez de la Torre","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Matehuala","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Mazatlan","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Monterrey","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Monterrey Centro","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Morelia Camelinas","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Morelia Madero","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Navojoa","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"Oaxaca","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Ocotlan de Morelos","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Orizaba","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Papantla","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Patzcuaro","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Puebla","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"Queretaro","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"Rio Verde","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Sahuayo","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Salamanca","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"Saltillo","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"San Andres","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"San Juan del Rio","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"San Luis","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Centro","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"San Luis Zona Industrial","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"Santa Catarina","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"Tacambaro","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Tala","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tapachula","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Tecpan de Galeana","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Tepic","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"Tlajomulco","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tlaxiaco","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tonala Centro","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"Tonala Chiapas","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Torreon","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"Tuxtepec","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"Tuxtla","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Uruapan Centro","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Veracruz","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"Villa Flores","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"Villa Victoria","sucursal_real":"Villa Victoria Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"Villahermosa Olmeca","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"Zacapu","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zamora","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"Zihuatanejo","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"Zitacuaro","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Xochimilco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santa Cruz Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Valle de Chalco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chalco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tulyehualco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ayotla Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Lorenzo Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pantitlan Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Milpa Alta Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"La Joya Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iztapalapa Oriente Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iztacalco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ixtapaluca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Eduardo Molina Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chimalhuacan Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cafetales Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ajusco Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Orizaba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pachuca Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Papantla Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Patzcuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Pijijiapan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Puebla Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Puerto Vallarta Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Queretaro Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Rio Verde Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Sahuayo Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Salamanca Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Saltillo Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Andres Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Cristobal Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Juan Del Rio Multiproducto","estado":"QuerÃ©taro"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Centro Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Luis Zona Industrial Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"San Martin Texmelucan Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santa Catarina Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Santiago Ixcuintla Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Silao Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Suchiate Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tacambaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Conmigo Vales Hermosillo","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuernavaca Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acambaro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acayucan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Actopan Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Aguascalientes Multiproducto","estado":"Aguascalientes"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Apatzingan Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Apatzingan Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Atlacomulco Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tapachula Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tapachula Norte Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Taxco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecamac Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecamachalco Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecoman Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tecpan de Galeana Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tepic Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Teziutlan Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tierra Blanca Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tlajomulco Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tlaxiaco Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Toluca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tonala Chiapas Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Torreon Multiproducto","estado":"Coahuila de Zaragoza"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tula Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tulancingo Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxpan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtepec Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtla Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Tuxtla Libramiento Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Uruapan Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Veracruz Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villa Cuauhtemoc Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villaflores Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villahermosa Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Villahermosa Olmeca Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Xalapa Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zacapu Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zacatecas Multiproducto","estado":"Zacatecas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zamora Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zapopan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zihuatanejo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zinacantepec Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zitacuaro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Zumpango Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Centro Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Acapulco Renacimiento Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Atoyac Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Autlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Boca del Rio Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Bucerias Multiproducto","estado":"Nayarit"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Catemaco Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cd Hidalgo Multiproducto","estado":"Hidalgo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cd Obregon Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Celaya Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Celaya Centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilapa Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilpancingo Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Chilpancingo Norte Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Coatzacoalcos Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cocula Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Colima Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Comitan Multiproducto","estado":"Chiapas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cordoba Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cosamaloapan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuajimalpa Multiproducto","estado":"CDMX"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuautla Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Cuernavaca Boulevard Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Culiacan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Dolores Hidalgo Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Durango Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Etla Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Gomez Palacio Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalajara Oblatos Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalajara Centro Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guadalupe Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guamuchil Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Guanajuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Hermosillo Multiproducto","estado":"Sonora"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Heroica Cardenas Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Huahuchinango Multiproducto","estado":"Puebla"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Huajuapan de Leon Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Iguala Multiproducto","estado":"Guerrero"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Irapuato Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ixtlahuaca Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Jojutla Multiproducto","estado":"Morelos"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Juchitan Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"La Piedad Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lagos de Moreno Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lazaro Cardenas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Leon centro Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lerdo Multiproducto","estado":"Durango"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Lerma Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Loreto Multiproducto","estado":"Zacatecas"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Los Mochis Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Los Reyes Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Macuspana Multiproducto","estado":"Tabasco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Manzanillo Multiproducto","estado":"Colima"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Martinez de la Torre Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Matehuala Multiproducto","estado":"San Luis Potosi"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Mazatlan Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Miahuatlan Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Minatitlan Multiproducto","estado":"Veracruz de Ignacio de la Llave"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Monterrey Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Monterrey Centro Multiproducto","estado":"Nuevo LeÃ³n"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Camelinas Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Centro Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Morelia Madero Multiproducto","estado":"MichoacÃ¡n de Ocampo"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Moroleon Multiproducto","estado":"Guanajuato"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Navojoa Multiproducto","estado":"Sinaloa"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Neza Multiproducto","estado":"Estado de MÃ©xico"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Oaxaca Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ocotlan Multiproducto","estado":"Jalisco"},{"sucursal_jucavi":"sin_sucursal","sucursal_real":"Ocotlan de Morelos Multiproducto","estado":"Oaxaca"},{"sucursal_jucavi":"CD Altamirano","sucursal_real":"CD Altamirano Multiproducto","estado":"Guerrero"}]';

        $sucursales = json_decode($verdaderassucursales, true);

        //return $sucursales;

        $countjucavi = count($sucursalesjucavi);
        $countsucursales = count($sucursales);

        //return $countjucavi;
        //return $countsucursales;

        // Se coloca la sucursal verdadera y estado de jucavi
        for ($i = 0; $i < $countjucavi; $i++) {
            for ($j = 0; $j < $countsucursales; $j++) {
                if ($sucursalesjucavi[$i]["sucursal"] === $sucursales[$j]["sucursal_jucavi"]) {
                    $sucursalesjucavi[$i]["sucursal"] = $sucursales[$j]["sucursal_real"];
                    $sucursalesjucavi[$i]["estado"] = $sucursales[$j]["estado"];
                    break; // Terminamos la bÃºsqueda una vez que se encuentra una coincidencia
                }
            }
        }

        $estadosmambuarray = json_decode($estadosmambu, true);

        //return $estadosmambuarray;

        // Se colola el estado a mambu
        $countmambu = count($sucursalesmambu);
        $countsucursales = count($estadosmambuarray);

        for ($i = 0; $i < $countmambu; $i++) {
            for ($j = 0; $j < $countsucursales; $j++) {
                if ($sucursalesmambu[$i]["sucursal"] === $estadosmambuarray[$j]["sucursal_real"]) {
                    $sucursalesmambu[$i]["estado"] = $estadosmambuarray[$j]["estado"];
                    break; // Terminamos la bÃºsqueda una vez que se encuentra una coincidencia
                }
            }
        }

        $unido = array_merge($sucursalesjucavi, $sucursalesmambu);


        $sumatoriaSaldoCapital = 0.0;
        $sumatoriaSaldoInteres = 0.0;
        $sumatoriaSaldoInteresIva = 0.0;
        $nedestItem = [];

        //return $unido;

        for ($i = 0; $i <= count($unido); $i++)
        {
            $sumatoriaSaldoCapital = $sumatoriaSaldoCapital + $unido[0]['saldo capital'];
            $sumatoriaSaldoInteres = $sumatoriaSaldoInteres + $unido[0]['saldo interes'];
            $sumatoriaSaldoInteresIva = $sumatoriaSaldoInteresIva + $unido[0]['saldo interes iva'];
        }
        $sumatoriaSaldoCapital = number_format($sumatoriaSaldoCapital, 2);
        $sumatoriaSaldoInteres = number_format($sumatoriaSaldoInteres, 2);
        $sumatoriaSaldoInteresIva = number_format($sumatoriaSaldoInteresIva, 2);

        //return $sumatoriaSaldoCapital;

        $nedestItem['credito'] = '';
        $nedestItem['nombre grupo'] = '';
        $nedestItem['monto otorgado'] = '';
        $nedestItem['fecha desembolso'] = '';
        $nedestItem['fecha vencimiento'] = 'TOTALES:';
        $nedestItem['saldo capital'] = $sumatoriaSaldoCapital;
        $nedestItem['saldo interes'] = $sumatoriaSaldoInteres;
        $nedestItem['saldo interes iva'] = $sumatoriaSaldoInteresIva;
        $nedestItem['cuotas restantes'] = '';
        $nedestItem['periodicidad'] = '';
        $nedestItem['sucursal'] = '';
        //return $nedestItem;
        $unido[] = $nedestItem;

        //return (["Jucavi"=>$sucursalesjucavi,"Mambu"=>$sucursalesmambu, "Unificado"=> $unido, "Cantidad"=>count($unido)]);
        return $unido;

        //***************************************************TERMINA PREPARACION DE LOS JSON ***************************************** */
    }

}
